import matplotlib.pyplot as plt
import numpy as np
import os
import sys
import pandas as pd

def process_loss_temp():
    loss = '''TIME:1 ,MAE:0.02789,  MAPE: 12232.72639, MSE: 0.00256
TIME:2 ,MAE:0.02968,  MAPE: 12236.60663, MSE: 0.00306
TIME:3 ,MAE:0.02965,  MAPE: 12405.70711, MSE: 0.00310
TIME:4 ,MAE:0.02895,  MAPE: 12143.83313, MSE: 0.00306
TIME:5 ,MAE:0.02839,  MAPE: 11351.86442, MSE: 0.00315
TIME:6 ,MAE:0.02804,  MAPE: 11131.90768, MSE: 0.00317
TIME:7 ,MAE:0.02836,  MAPE: 11311.12973, MSE: 0.00322
TIME:8 ,MAE:0.02866,  MAPE: 11400.17980, MSE: 0.00329
TIME:9 ,MAE:0.02857,  MAPE: 11210.32671, MSE: 0.00333
TIME:10 ,MAE:0.02862,  MAPE: 11114.49266, MSE: 0.00341
TIME:11 ,MAE:0.02844,  MAPE: 10928.21677, MSE: 0.00345
TIME:12 ,MAE:0.02833,  MAPE: 10877.56506, MSE: 0.00345
TIME:13 ,MAE:0.02825,  MAPE: 10763.17261, MSE: 0.00348
TIME:14 ,MAE:0.02830,  MAPE: 10779.19809, MSE: 0.00351
TIME:15 ,MAE:0.02845,  MAPE: 10804.05007, MSE: 0.00356
TIME:16 ,MAE:0.02845,  MAPE: 10748.36190, MSE: 0.00358
TIME:17 ,MAE:0.02844,  MAPE: 10600.11030, MSE: 0.00364
TIME:18 ,MAE:0.02859,  MAPE: 10610.08651, MSE: 0.00370
TIME:19 ,MAE:0.02850,  MAPE: 10419.58375, MSE: 0.00375
TIME:20 ,MAE:0.02858,  MAPE: 10386.90626, MSE: 0.00380
TIME:21 ,MAE:0.02891,  MAPE: 10544.49340, MSE: 0.00388
TIME:22 ,MAE:0.02888,  MAPE: 10464.00146, MSE: 0.00391
TIME:23 ,MAE:0.02886,  MAPE: 10341.95992, MSE: 0.00396
TIME:24 ,MAE:0.02892,  MAPE: 10265.49972, MSE: 0.00402
TIME:25 ,MAE:0.02919,  MAPE: 10386.20714, MSE: 0.00409
TIME:26 ,MAE:0.02926,  MAPE: 10323.80067, MSE: 0.00415
TIME:27 ,MAE:0.02925,  MAPE: 10179.51577, MSE: 0.00421
TIME:28 ,MAE:0.02942,  MAPE: 10222.25866, MSE: 0.00427
TIME:29 ,MAE:0.02959,  MAPE: 10255.45699, MSE: 0.00434
TIME:30 ,MAE:0.02971,  MAPE: 10237.75711, MSE: 0.00440
TIME:31 ,MAE:0.02978,  MAPE: 10152.51967, MSE: 0.00447
TIME:32 ,MAE:0.02981,  MAPE: 10083.24516, MSE: 0.00452
TIME:33 ,MAE:0.02983,  MAPE: 10028.31508, MSE: 0.00456
TIME:34 ,MAE:0.02990,  MAPE: 9985.65502, MSE: 0.00462
TIME:35 ,MAE:0.03000,  MAPE: 9952.36111, MSE: 0.00468
TIME:36 ,MAE:0.03010,  MAPE: 9915.54835, MSE: 0.00476
TIME:37 ,MAE:0.03024,  MAPE: 9883.17460, MSE: 0.00484
TIME:38 ,MAE:0.03036,  MAPE: 9833.08679, MSE: 0.00493
TIME:39 ,MAE:0.03054,  MAPE: 9870.68605, MSE: 0.00500
TIME:40 ,MAE:0.03063,  MAPE: 9839.34025, MSE: 0.00507
TIME:41 ,MAE:0.03073,  MAPE: 9781.07340, MSE: 0.00515
TIME:42 ,MAE:0.03091,  MAPE: 9784.41702, MSE: 0.00524
TIME:43 ,MAE:0.03104,  MAPE: 9810.22853, MSE: 0.00529
TIME:44 ,MAE:0.03115,  MAPE: 9769.71480, MSE: 0.00538
TIME:45 ,MAE:0.03130,  MAPE: 9777.39178, MSE: 0.00545
TIME:46 ,MAE:0.03143,  MAPE: 9768.47030, MSE: 0.00552
TIME:47 ,MAE:0.03156,  MAPE: 9731.65796, MSE: 0.00561
TIME:48 ,MAE:0.03172,  MAPE: 9731.56000, MSE: 0.00569
TIME:49 ,MAE:0.03183,  MAPE: 9686.19843, MSE: 0.00578
TIME:50 ,MAE:0.03196,  MAPE: 9669.31614, MSE: 0.00586
TIME:51 ,MAE:0.03206,  MAPE: 9629.73466, MSE: 0.00594
TIME:52 ,MAE:0.03227,  MAPE: 9674.74793, MSE: 0.00602
TIME:53 ,MAE:0.03247,  MAPE: 9680.70441, MSE: 0.00613
TIME:54 ,MAE:0.03261,  MAPE: 9635.75711, MSE: 0.00624
TIME:55 ,MAE:0.03286,  MAPE: 9676.64461, MSE: 0.00636
TIME:56 ,MAE:0.03308,  MAPE: 9702.95216, MSE: 0.00646
TIME:57 ,MAE:0.03327,  MAPE: 9713.61170, MSE: 0.00656
TIME:58 ,MAE:0.03349,  MAPE: 9733.05072, MSE: 0.00667
TIME:59 ,MAE:0.03372,  MAPE: 9750.28639, MSE: 0.00680
TIME:60 ,MAE:0.03391,  MAPE: 9742.03325, MSE: 0.00692
TIME:61 ,MAE:0.03416,  MAPE: 9772.08749, MSE: 0.00705
TIME:62 ,MAE:0.03438,  MAPE: 9759.05649, MSE: 0.00719
TIME:63 ,MAE:0.03459,  MAPE: 9748.28115, MSE: 0.00733
TIME:64 ,MAE:0.03479,  MAPE: 9725.53878, MSE: 0.00747
TIME:65 ,MAE:0.03501,  MAPE: 9724.67437, MSE: 0.00762
TIME:66 ,MAE:0.03524,  MAPE: 9725.99895, MSE: 0.00776
TIME:67 ,MAE:0.03549,  MAPE: 9757.63612, MSE: 0.00790
TIME:68 ,MAE:0.03573,  MAPE: 9760.08397, MSE: 0.00805
TIME:69 ,MAE:0.03597,  MAPE: 9758.08009, MSE: 0.00821
TIME:70 ,MAE:0.03623,  MAPE: 9791.43365, MSE: 0.00835
TIME:71 ,MAE:0.03648,  MAPE: 9815.07112, MSE: 0.00850
TIME:72 ,MAE:0.03673,  MAPE: 9845.29283, MSE: 0.00864
TIME:73 ,MAE:0.03697,  MAPE: 9862.15127, MSE: 0.00879
TIME:74 ,MAE:0.03722,  MAPE: 9873.50513, MSE: 0.00895
TIME:75 ,MAE:0.03748,  MAPE: 9894.94812, MSE: 0.00910
TIME:76 ,MAE:0.03776,  MAPE: 9921.45818, MSE: 0.00927
TIME:77 ,MAE:0.03802,  MAPE: 9959.80137, MSE: 0.00941
TIME:78 ,MAE:0.03829,  MAPE: 9987.10245, MSE: 0.00957
TIME:79 ,MAE:0.03853,  MAPE: 9992.22698, MSE: 0.00973
TIME:80 ,MAE:0.03878,  MAPE: 9995.24232, MSE: 0.00989
TIME:81 ,MAE:0.03904,  MAPE: 10020.67582, MSE: 0.01005
TIME:82 ,MAE:0.03930,  MAPE: 10052.75728, MSE: 0.01019
TIME:83 ,MAE:0.03956,  MAPE: 10087.91517, MSE: 0.01035
TIME:84 ,MAE:0.03982,  MAPE: 10108.04367, MSE: 0.01050
TIME:85 ,MAE:0.04007,  MAPE: 10115.96847, MSE: 0.01066
TIME:86 ,MAE:0.04032,  MAPE: 10134.66086, MSE: 0.01082
TIME:87 ,MAE:0.04058,  MAPE: 10171.81472, MSE: 0.01096
TIME:88 ,MAE:0.04082,  MAPE: 10195.02397, MSE: 0.01111
TIME:89 ,MAE:0.04106,  MAPE: 10207.04338, MSE: 0.01126
TIME:90 ,MAE:0.04134,  MAPE: 10243.23669, MSE: 0.01142
TIME:91 ,MAE:0.04158,  MAPE: 10267.65995, MSE: 0.01157
TIME:92 ,MAE:0.04183,  MAPE: 10300.83347, MSE: 0.01171
TIME:93 ,MAE:0.04206,  MAPE: 10318.08972, MSE: 0.01186
TIME:94 ,MAE:0.04231,  MAPE: 10351.64553, MSE: 0.01201
TIME:95 ,MAE:0.04256,  MAPE: 10387.02343, MSE: 0.01216
TIME:96 ,MAE:0.04282,  MAPE: 10433.62104, MSE: 0.01232
TIME:97 ,MAE:0.04306,  MAPE: 10470.33059, MSE: 0.01246
TIME:98 ,MAE:0.04326,  MAPE: 10477.74984, MSE: 0.01260
TIME:99 ,MAE:0.04348,  MAPE: 10510.08716, MSE: 0.01274
TIME:100 ,MAE:0.04372,  MAPE: 10564.67279, MSE: 0.01288
TIME:101 ,MAE:0.04394,  MAPE: 10606.32145, MSE: 0.01301
TIME:102 ,MAE:0.04418,  MAPE: 10671.81343, MSE: 0.01315
TIME:103 ,MAE:0.04440,  MAPE: 10726.67878, MSE: 0.01328
TIME:104 ,MAE:0.04460,  MAPE: 10755.37401, MSE: 0.01341
TIME:105 ,MAE:0.04483,  MAPE: 10812.98164, MSE: 0.01354
TIME:106 ,MAE:0.04503,  MAPE: 10847.46885, MSE: 0.01367
TIME:107 ,MAE:0.04523,  MAPE: 10889.23472, MSE: 0.01380
TIME:108 ,MAE:0.04544,  MAPE: 10940.16566, MSE: 0.01392
TIME:109 ,MAE:0.04565,  MAPE: 10986.04100, MSE: 0.01406
TIME:110 ,MAE:0.04588,  MAPE: 11037.19089, MSE: 0.01420
TIME:111 ,MAE:0.04608,  MAPE: 11076.15061, MSE: 0.01433
TIME:112 ,MAE:0.04628,  MAPE: 11107.39163, MSE: 0.01447
TIME:113 ,MAE:0.04649,  MAPE: 11147.31404, MSE: 0.01460
TIME:114 ,MAE:0.04670,  MAPE: 11180.61063, MSE: 0.01475
TIME:115 ,MAE:0.04693,  MAPE: 11241.09927, MSE: 0.01488
TIME:116 ,MAE:0.04712,  MAPE: 11271.74159, MSE: 0.01501
TIME:117 ,MAE:0.04735,  MAPE: 11328.61060, MSE: 0.01514
TIME:118 ,MAE:0.04755,  MAPE: 11341.20358, MSE: 0.01528
TIME:119 ,MAE:0.04776,  MAPE: 11373.24283, MSE: 0.01542
TIME:120 ,MAE:0.04796,  MAPE: 11397.18711, MSE: 0.01555
TIME:121 ,MAE:0.04817,  MAPE: 11420.70334, MSE: 0.01569
TIME:122 ,MAE:0.04837,  MAPE: 11443.34285, MSE: 0.01583
TIME:123 ,MAE:0.04858,  MAPE: 11475.21016, MSE: 0.01596
TIME:124 ,MAE:0.04883,  MAPE: 11530.31097, MSE: 0.01610
TIME:125 ,MAE:0.04904,  MAPE: 11554.85908, MSE: 0.01625
TIME:126 ,MAE:0.04925,  MAPE: 11562.83858, MSE: 0.01640
TIME:127 ,MAE:0.04948,  MAPE: 11594.25827, MSE: 0.01654
TIME:128 ,MAE:0.04972,  MAPE: 11634.12699, MSE: 0.01669
TIME:129 ,MAE:0.04992,  MAPE: 11646.65041, MSE: 0.01683
TIME:130 ,MAE:0.05014,  MAPE: 11659.41542, MSE: 0.01698
TIME:131 ,MAE:0.05038,  MAPE: 11688.74824, MSE: 0.01713
TIME:132 ,MAE:0.05060,  MAPE: 11699.57331, MSE: 0.01729
TIME:133 ,MAE:0.05080,  MAPE: 11702.32109, MSE: 0.01743
TIME:134 ,MAE:0.05103,  MAPE: 11731.23271, MSE: 0.01757
TIME:135 ,MAE:0.05125,  MAPE: 11746.54278, MSE: 0.01771
TIME:136 ,MAE:0.05148,  MAPE: 11765.76953, MSE: 0.01786
TIME:137 ,MAE:0.05171,  MAPE: 11780.50752, MSE: 0.01801
TIME:138 ,MAE:0.05190,  MAPE: 11768.88378, MSE: 0.01815
TIME:139 ,MAE:0.05214,  MAPE: 11789.21361, MSE: 0.01830
TIME:140 ,MAE:0.05235,  MAPE: 11787.46250, MSE: 0.01844
TIME:141 ,MAE:0.05258,  MAPE: 11811.94421, MSE: 0.01858
TIME:142 ,MAE:0.05279,  MAPE: 11816.58186, MSE: 0.01872
TIME:143 ,MAE:0.05298,  MAPE: 11807.91156, MSE: 0.01884
TIME:144 ,MAE:0.05320,  MAPE: 11816.89149, MSE: 0.01897
TIME:145 ,MAE:0.05338,  MAPE: 11815.76872, MSE: 0.01908
TIME:146 ,MAE:0.05357,  MAPE: 11819.41941, MSE: 0.01920
TIME:147 ,MAE:0.05374,  MAPE: 11805.80386, MSE: 0.01930
TIME:148 ,MAE:0.05390,  MAPE: 11788.64768, MSE: 0.01940
TIME:149 ,MAE:0.05407,  MAPE: 11784.13735, MSE: 0.01950
TIME:150 ,MAE:0.05423,  MAPE: 11772.77683, MSE: 0.01959'''
# get the mse and print as lis
    loss_list = loss.split('\n')
    mse_list = []
    for i in loss_list:
        mse = i.split(',')[-1].split(':')[-1]
        mse_list.append(float(mse))
    print(mse_list)
    return mse_list

def plot_loss():
    # read graphgruloss.txt.npy from ./data/
    loss = np.load('./data/graphgruloss150_60.txt.npy')
    print(loss)
    # plt.plot(np.log(loss))
    plt.plot(loss)
    plt.xlabel('Epoch')
    plt.ylabel('Loss')
    plt.title('GraphGRU Loss')
    # plt.show()
    plt.savefig('./data/fig/graphgru_training_loss_90_60.png')

    loss_string = '''133it [05:01,  2.27s/it]
epoch:0,  loss: 0.02686
model saved
133it [04:51,  2.19s/it]
epoch:1,  loss: 0.02256
133it [04:51,  2.19s/it]
epoch:2,  loss: 0.02225
133it [04:52,  2.20s/it]
epoch:3,  loss: 0.02205
133it [04:50,  2.18s/it]
epoch:4,  loss: 0.02188
133it [04:50,  2.19s/it]
epoch:5,  loss: 0.02170
133it [04:50,  2.19s/it]
epoch:6,  loss: 0.02151
133it [04:51,  2.19s/it]
epoch:7,  loss: 0.02135
133it [04:50,  2.19s/it]
epoch:8,  loss: 0.02115
133it [04:51,  2.19s/it]
epoch:9,  loss: 0.02110
133it [04:51,  2.19s/it]
epoch:10,  loss: 0.02098
model saved
133it [04:50,  2.18s/it]
epoch:11,  loss: 0.02090
133it [04:51,  2.19s/it]
epoch:12,  loss: 0.02079
133it [04:51,  2.19s/it]
epoch:13,  loss: 0.02080
133it [04:52,  2.20s/it]
epoch:14,  loss: 0.02074
133it [04:50,  2.18s/it]
epoch:15,  loss: 0.02073
133it [04:49,  2.18s/it]
epoch:16,  loss: 0.02064
133it [04:50,  2.19s/it]
epoch:17,  loss: 0.02093
133it [04:50,  2.18s/it]
epoch:18,  loss: 0.02092
133it [04:51,  2.19s/it]
epoch:19,  loss: 0.02047
133it [05:06,  2.30s/it]
epoch:20,  loss: 0.02046
model saved
133it [04:53,  2.20s/it]
epoch:21,  loss: 0.02043
133it [04:47,  2.16s/it]
epoch:22,  loss: 0.02038
133it [04:44,  2.14s/it]
epoch:23,  loss: 0.02035
133it [04:42,  2.13s/it]
epoch:24,  loss: 0.02031
133it [04:41,  2.11s/it]
epoch:25,  loss: 0.02036
133it [04:41,  2.12s/it]
epoch:26,  loss: 0.02047
133it [04:41,  2.12s/it]
epoch:27,  loss: 0.02028
133it [04:41,  2.12s/it]
epoch:28,  loss: 0.02020
133it [04:42,  2.13s/it]
epoch:29,  loss: 0.02014
133it [04:41,  2.12s/it]
epoch:30,  loss: 0.02010
model saved
133it [04:42,  2.12s/it]
epoch:31,  loss: 0.02014
133it [04:47,  2.16s/it]
epoch:32,  loss: 0.02016
133it [04:42,  2.12s/it]
epoch:33,  loss: 0.02013
133it [04:41,  2.11s/it]
epoch:34,  loss: 0.02011
133it [04:40,  2.11s/it]
epoch:35,  loss: 0.02022
133it [04:41,  2.11s/it]
epoch:36,  loss: 0.02013
133it [04:42,  2.12s/it]
epoch:37,  loss: 0.01990
133it [04:42,  2.12s/it]
epoch:38,  loss: 0.01979
133it [04:41,  2.12s/it]
epoch:39,  loss: 0.01975
133it [04:42,  2.13s/it]
epoch:40,  loss: 0.01979
model saved
133it [04:41,  2.12s/it]
epoch:41,  loss: 0.01986
133it [04:41,  2.12s/it]
epoch:42,  loss: 0.01980
133it [04:42,  2.12s/it]
epoch:43,  loss: 0.01969
133it [05:07,  2.31s/it]
epoch:44,  loss: 0.01972
133it [04:41,  2.12s/it]
epoch:45,  loss: 0.01961
133it [04:41,  2.11s/it]
epoch:46,  loss: 0.01960
133it [04:42,  2.13s/it]
epoch:47,  loss: 0.01952
133it [04:41,  2.12s/it]
epoch:48,  loss: 0.01952
133it [04:41,  2.12s/it]
epoch:49,  loss: 0.01951
133it [04:41,  2.12s/it]
epoch:50,  loss: 0.01952
model saved
133it [04:42,  2.12s/it]
epoch:51,  loss: 0.01950
133it [04:41,  2.12s/it]
epoch:52,  loss: 0.01953
133it [04:42,  2.12s/it]
epoch:53,  loss: 0.01949
133it [05:21,  2.42s/it]
epoch:54,  loss: 0.01942
133it [04:42,  2.13s/it]
epoch:55,  loss: 0.01932
133it [04:41,  2.12s/it]
epoch:56,  loss: 0.01929
133it [04:42,  2.12s/it]
epoch:57,  loss: 0.01919
133it [04:40,  2.11s/it]
epoch:58,  loss: 0.01926
133it [04:42,  2.12s/it]
epoch:59,  loss: 0.01927
133it [04:41,  2.12s/it]
epoch:60,  loss: 0.01921
model saved
133it [04:41,  2.11s/it]
epoch:61,  loss: 0.01916
133it [04:41,  2.12s/it]
epoch:62,  loss: 0.01905
133it [04:42,  2.12s/it]
epoch:63,  loss: 0.01902
133it [04:42,  2.12s/it]
epoch:64,  loss: 0.01912
133it [04:41,  2.12s/it]
epoch:65,  loss: 0.01921
133it [04:41,  2.12s/it]
epoch:66,  loss: 0.01938
133it [04:40,  2.11s/it]
epoch:67,  loss: 0.01928
133it [04:41,  2.12s/it]
epoch:68,  loss: 0.01907
133it [04:43,  2.13s/it]
epoch:69,  loss: 0.01899
133it [04:41,  2.12s/it]
epoch:70,  loss: 0.01879
model saved
133it [04:41,  2.12s/it]
epoch:71,  loss: 0.01871
133it [04:41,  2.12s/it]
epoch:72,  loss: 0.01915
133it [04:41,  2.12s/it]
epoch:73,  loss: 0.01940
133it [04:40,  2.11s/it]
epoch:74,  loss: 0.01910
133it [04:41,  2.11s/it]
epoch:75,  loss: 0.01900
133it [04:46,  2.15s/it]
epoch:76,  loss: 0.01878
133it [04:41,  2.12s/it]
epoch:77,  loss: 0.01860
133it [04:40,  2.11s/it]
epoch:78,  loss: 0.01853
133it [04:42,  2.13s/it]'''
    loss_string = loss_string.split('\n')
    loss_string = [x.split(',') for x in loss_string if x[0] == 'e']
    # import pdb; pdb.set_trace()
    loss_mse = [x[1].split(':') for x in loss_string]
    loss_mse = [float(x[1]) for x in loss_mse]
    print(loss_mse)
    plt.plot(loss_mse, label='MAE')
    plt.xlabel('Epoch')
    plt.ylabel('Loss')
    plt.title('GraphGRU Loss')
    plt.savefig('./data/fig/graphgru_training_loss.png')


def plot_test_loss(test_loss_list):
    for test_loss in test_loss_list:
        test_loss = test_loss.split('\n')
        test_loss = [x.split(',') for x in test_loss]
        test_loss_mae = [x[1].split(':') for x in test_loss]
        test_loss_mae = [float(x[1]) for x in test_loss_mae]
        print(test_loss_mae)
        plt.plot(test_loss_mae, label='MAE')
        plt.xlabel('Time')
        plt.ylabel('Loss')
        plt.title('GraphGRU Test Loss')

        test_loss_mse = [x[3].split(':') for x in test_loss]
        test_loss_mse = [float(x[1]) for x in test_loss_mse]
        print(test_loss_mse)
        plt.plot(test_loss_mse, label='MSE')
        plt.xlabel('Time')
        plt.ylabel('Loss')
        plt.title('GraphGRU Test Loss')
        plt.legend()
        # plt.show()
    plt.savefig('./data/fig/graphgru_test_loss.png')




    plt.savefig('./data/fig/graphgru_test_loss_90_60.png')


def plot_loss_with_some_points():
    # MSE = [0.0011824649991467595, 0.0015528767835348845, 0.0019689053297042847, 0.0024274634197354317, 0.002800989430397749, 0.0031833541579544544, 0.0035882091615349054, 0.003919435199350119, 0.00428751902654767, 0.004600231070071459]
    # MSE = [0.00256, 0.00306, 0.0031, 0.00306, 0.00315, 0.00317, 0.00322, 0.00329, 0.00333, 0.00341, 0.00345, 0.00345, 0.00348, 0.00351, 0.00356, 0.00358, 0.00364, 0.0037, 0.00375, 0.0038, 0.00388, 0.00391, 0.00396, 0.00402, 0.00409, 0.00415, 0.00421, 0.00427, 0.00434, 0.0044, 0.00447, 0.00452, 0.00456, 0.00462, 0.00468, 0.00476, 0.00484, 0.00493, 0.005, 0.00507, 0.00515, 0.00524, 0.00529, 0.00538, 0.00545, 0.00552, 0.00561, 0.00569, 0.00578, 0.00586, 0.00594, 0.00602, 0.00613, 0.00624, 0.00636, 0.00646, 0.00656, 0.00667, 0.0068, 0.00692, 0.00705, 0.00719, 0.00733, 0.00747, 0.00762, 0.00776, 0.0079, 0.00805, 0.00821, 0.00835, 0.0085, 0.00864, 0.00879, 0.00895, 0.0091, 0.00927, 0.00941, 0.00957, 0.00973, 0.00989, 0.01005, 0.01019, 0.01035, 0.0105, 0.01066, 0.01082, 0.01096, 0.01111, 0.01126, 0.01142, 0.01157, 0.01171, 0.01186, 0.01201, 0.01216, 0.01232, 0.01246, 0.0126, 0.01274, 0.01288, 0.01301, 0.01315, 0.01328, 0.01341, 0.01354, 0.01367, 0.0138, 0.01392, 0.01406, 0.0142, 0.01433, 0.01447, 0.0146, 0.01475, 0.01488, 0.01501, 0.01514, 0.01528, 0.01542, 0.01555, 0.01569, 0.01583, 0.01596, 0.0161, 0.01625, 0.0164, 0.01654, 0.01669, 0.01683, 0.01698, 0.01713, 0.01729, 0.01743, 0.01757, 0.01771, 0.01786, 0.01801, 0.01815, 0.0183, 0.01844, 0.01858, 0.01872, 0.01884, 0.01897, 0.01908, 0.0192, 0.0193, 0.0194, 0.0195, 0.01959]
    MSE = [0.0012872619554400444, 0.0018613685388118029, 0.002352084033191204, 0.002792186103761196, 0.0031943644862622023, 0.003623957745730877, 0.004000197630375624, 0.004373016767203808, 0.004746017046272755, 0.005084986332803965, 0.005422185640782118, 0.005731487646698952, 0.005994910839945078, 0.00626274012029171, 0.00654884846881032, 0.0068427883088588715, 0.007111128885298967, 0.007333769463002682, 0.007617655675858259, 0.007883657701313496, 0.008068714290857315, 0.008296739310026169, 0.008472231216728687, 0.008770070038735867, 0.008952060714364052, 0.009104020893573761, 0.009309201501309872, 0.009474027901887894, 0.009632940404117107, 0.009812209755182266, 0.010019661858677864, 0.010136814787983894, 0.010295497253537178, 0.01039459090679884, 0.010512900538742542, 0.010669684037566185, 0.010854213498532772, 0.010960877873003483, 0.011045856401324272, 0.011157204397022724, 0.011254789307713509, 0.01139143668115139, 0.011501087807118893, 0.011578877456486225, 0.011634735390543938, 0.01176370121538639, 0.011830940842628479, 0.011942679062485695, 0.012000633403658867, 0.012097573839128017, 0.012129520997405052, 0.012265141122043133, 0.012240137904882431, 0.012311586178839207, 0.012374014593660831, 0.012375200167298317, 0.012434539385139942, 0.012427003122866154, 0.012425093911588192, 0.012423871085047722]
    MSE_G1 = [0.002756791654974222, 0.0031334576196968555, 0.0033957224804908037, 0.0038000796921551228, 0.004178802017122507, 0.00459236791357398, 0.0048831552267074585, 0.0052232625894248486, 0.0055979457683861256, 0.005836393218487501, 0.006160767748951912, 0.006479048170149326, 0.0067404466681182384, 0.007065732032060623, 0.007216151803731918, 0.007450989913195372, 0.007717170752584934, 0.008021224290132523, 0.008238171227276325, 0.008468342944979668, 0.008653176948428154, 0.008837430737912655, 0.009112689644098282, 0.009296661242842674, 0.009498138912022114, 0.009715464897453785, 0.009896114468574524, 0.010064588859677315, 0.010165512561798096, 0.010351190343499184, 0.010559680871665478, 0.010730696842074394, 0.010841789655387402, 0.010965628549456596, 0.011131730861961842, 0.011248918250203133, 0.011409986764192581, 0.01147595513612032, 0.011648379266262054, 0.011753849685192108, 0.011905296705663204, 0.012034433893859386, 0.012116204015910625, 0.012235693633556366, 0.01230714377015829, 0.012438008561730385, 0.012545366771519184, 0.012595489621162415, 0.01268916018307209, 0.012747599743306637, 0.012893631123006344, 0.012918147258460522, 0.012972278520464897, 0.013009677641093731, 0.013100746087729931, 0.01313843484967947, 0.013229772448539734, 0.01333438977599144, 0.013367878273129463, 0.013355729170143604]
    MSE_G1_full = [0.001786818029358983, 0.002273403573781252, 0.002730956766754389, 0.003161907894536853, 0.0035400032065808773, 0.003952395636588335, 0.004292439669370651, 0.004701206460595131, 0.005014939233660698, 0.005345167126506567, 0.005612711887806654, 0.00593501515686512, 0.006216561421751976, 0.0064219096675515175, 0.006684798747301102, 0.006950632203370333, 0.007159413769841194, 0.007432576734572649, 0.007657869253307581, 0.007892397232353687, 0.008130784146487713, 0.008301796391606331, 0.008502484299242496, 0.008683232590556145, 0.008889332413673401, 0.009056121110916138, 0.009172353893518448, 0.009307218715548515, 0.009499354287981987, 0.009679474867880344, 0.009792475029826164, 0.009930280037224293, 0.009998598136007786, 0.010144926607608795, 0.010277556255459785, 0.010390061885118484, 0.010484798811376095, 0.010612512938678265, 0.010678622871637344, 0.010811656713485718, 0.01088424026966095, 0.010964720509946346, 0.01100864727050066, 0.011109180748462677, 0.011169467121362686, 0.011236517690122128, 0.011316752061247826, 0.011404692195355892, 0.011494225822389126, 0.011488335207104683, 0.011586954817175865, 0.011665115132927895, 0.011624094098806381, 0.011655456386506557, 0.011692844331264496, 0.01169782318174839, 0.011746049858629704, 0.01178721897304058, 0.011790527030825615, 0.011783828027546406]
    MSE_G1_full_90_150 = [0.002460610354319215, 0.0028566275723278522, 0.003152084769681096, 0.0034760828129947186, 0.0038222670555114746, 0.004170375410467386, 0.004580297041684389, 0.004896764177829027, 0.005172243807464838, 0.0054074847139418125, 0.0056981248781085014, 0.006009729113429785, 0.006207730155438185, 0.0064769466407597065, 0.006802255287766457, 0.007003156002610922, 0.007187412586063147, 0.0074110920540988445, 0.007616361603140831, 0.007898552343249321, 0.00798914022743702, 0.00825620535761118, 0.008440128527581692, 0.008614645339548588, 0.008774864487349987, 0.008949404582381248, 0.009162863716483116, 0.009337663650512695, 0.009459472261369228, 0.009699713438749313, 0.00976357702165842, 0.009957880713045597, 0.010115513578057289, 0.010270733386278152, 0.010335846804082394, 0.010440925136208534, 0.010519515722990036, 0.01072514895349741, 0.010808134451508522, 0.01089596375823021, 0.011105147190392017, 0.011179466731846333, 0.011310684494674206, 0.011329051107168198, 0.01145793404430151, 0.01147613674402237, 0.01166479755192995, 0.011732393875718117, 0.011793571524322033, 0.011809793300926685, 0.011862952262163162, 0.012020109221339226, 0.011926790699362755, 0.011980069801211357, 0.01197663601487875, 0.012206653133034706, 0.012226671911776066, 0.01220491249114275, 0.012446694076061249, 0.01239433977752924, 0.012414601631462574, 0.012454058043658733, 0.012591369450092316, 0.012539887800812721, 0.012508259154856205, 0.012697473168373108, 0.012680517509579659, 0.012708778493106365, 0.012922022491693497, 0.01297361683100462, 0.012908612377941608, 0.013015910983085632, 0.01313269603997469, 0.013189403340220451, 0.01323308888822794, 0.013158748857676983, 0.01331831980496645, 0.013507326133549213, 0.013395585119724274, 0.013442069292068481, 0.01355027873069048, 0.013731018640100956, 0.01375796552747488, 0.01385451015084982, 0.013987916521728039, 0.013986652716994286, 0.014150586910545826, 0.01423113513737917, 0.01428971253335476, 0.014312882907688618, 0.014361381530761719, 0.014404905959963799, 0.014471474103629589, 0.014459565281867981, 0.014549070037901402, 0.01462080143392086, 0.014603340066969395, 0.014810997992753983, 0.014766343869268894, 0.014727145433425903, 0.014835130423307419, 0.014783167280256748, 0.01477260421961546, 0.014875237829983234, 0.014770200476050377, 0.014867936260998249, 0.01490157749503851, 0.014887862838804722, 0.014860393479466438, 0.014974730089306831, 0.014901949092745781, 0.014965103939175606, 0.014951540157198906, 0.014917111955583096, 0.01487391535192728, 0.0147985415533185, 0.014903179369866848, 0.014847110025584698, 0.014809210784733295, 0.014816846698522568, 0.01478583924472332, 0.014784131199121475, 0.014791671186685562, 0.01468058954924345, 0.014726480469107628, 0.014679021202027798, 0.014592335559427738, 0.014649294316768646, 0.014564380049705505, 0.014493455179035664, 0.014516017399728298, 0.014464061707258224, 0.01445127371698618, 0.014415119774639606, 0.01441259030252695, 0.014431395567953587, 0.014324525371193886, 0.014241564087569714, 0.014269712381064892, 0.014255140908062458, 0.01419747993350029, 0.014199883677065372, 0.014106080867350101, 0.014122908003628254, 0.014059990644454956, 0.014000202529132366, 0.013934546150267124, 0.013915453106164932, 0.013851216062903404, 0.013783389702439308]
    # MAE =[0.014175975695252419, 0.015277200378477573, 0.0164263304322958, 0.017489546909928322, 0.01854783296585083, 0.01942448690533638, 0.02040746808052063, 0.021344339475035667, 0.02215290628373623, 0.023020528256893158, 0.02368580363690853, 0.024312060326337814, 0.02503584884107113, 0.025686252862215042, 0.026249995455145836, 0.026760172098875046, 0.027317438274621964, 0.02794686332345009, 0.028426695615053177, 0.028948776423931122, 0.029385995119810104, 0.02984929457306862, 0.03021187335252762, 0.030622657388448715, 0.031150463968515396, 0.03154768794775009, 0.03188407048583031, 0.03224803879857063, 0.032401420176029205, 0.03276808187365532, 0.033102016896009445, 0.0333375446498394, 0.03372472524642944, 0.03379673883318901, 0.03406703844666481, 0.034022215753793716, 0.03438208997249603, 0.03442130237817764, 0.03466606140136719, 0.03489881753921509, 0.03512019291520119, 0.035352129489183426, 0.03527214750647545, 0.03538960963487625, 0.03558524325489998, 0.035626672208309174, 0.03584333881735802, 0.035903241485357285, 0.035809360444545746, 0.035924267023801804, 0.036105405539274216, 0.03614910691976547, 0.03598684445023537, 0.035937488079071045, 0.036114636808633804, 0.03606199100613594, 0.03595395013689995, 0.03617316111922264, 0.036025095731019974, 0.03573495149612427]
    # plt.plot(MSE, label='T2model-h90 MSE')
    # plt.plot(MSE_G1, label='G1model-h90 MSE')
    plt.plot(MSE_G1_full, label='G1model-full-h90 MSE')
    plt.plot(MSE_G1_full_90_150, label='G1model-full-h90-150 MSE')
    # plt.plot(MAE, label='model-90 MAE')
    # plot some points
    Loss_list = [0.004,0.007,0.0129,0.0201]
    x_list = [1,10,30,60,150]
    Loss_list_LR_90 = [0.0044,0.007,0.0129,0.020]
    Loss_list_LR_30 = [0.0014,0.0043,0.0102,0.0173,0.0229]
    Loss_list_LR_10 = [0.0003,0.0027,0.0085,0.0158]
    Loss_list_TLP = [0.0006,0.0028,0.0085,0.0158,0.0223]
    mse_90_10 = [0.000827781215775758, 0.0012733683688566089, 0.0017457979265600443, 0.002192354528233409, 0.0026135274674743414, 0.0030442047864198685, 0.0034465992357581854, 0.003851033980026841, 0.004187089391052723, 0.004538446664810181]


    MAE_LR_90 = [0.01145,0.01607,0.0251,0.0354]
    # plot with dot mark
    # plt.plot(x_list, Loss_list, 'o', label='LR-h90 MSE')
    plt.plot(x_list, Loss_list_LR_30, 'x', label='LR-h30 MSE')
    # plt.plot(x_list[:4], Loss_list_LR_10, 'o',label='LR-h10 MSE')
    # plt.plot(x_list[:4], MAE_LR_90, 'x', label='LR-h90 MAE')
    plt.plot(x_list[:4], Loss_list_LR_90, 'x',label='LR-h90 MSE')
    plt.plot(x_list, Loss_list_TLP, 'o', label='TLP MSE')
    # plt.plot(mse_90_10, label='G1-h90 MSE')

    plt.xlabel('Prediction Horizon/frame')
    plt.ylabel('MSE Loss')
    plt.legend()
    plt.savefig('./data/fig/graphgru_loss_withTLR_to150.png')

def plot_different_future():
    mse_90_1 = [0.00059]
    mse_90_10 = [0.000827781215775758, 0.0012733683688566089, 0.0017457979265600443, 0.002192354528233409, 0.0026135274674743414, 0.0030442047864198685, 0.0034465992357581854, 0.003851033980026841, 0.004187089391052723, 0.004538446664810181]
    mse_90_30 = [0.0021916781552135944, 0.0025715979281812906, 0.0030753558967262506, 0.0035131103359162807, 0.003878258168697357, 0.004282331094145775, 0.004719122312963009, 0.005053541157394648, 0.005380124785006046, 0.005699321161955595, 0.006033469922840595, 0.006292897276580334, 0.00659156171604991, 0.006853446830064058, 0.0071793668903410435, 0.007398196030408144, 0.007660084404051304, 0.007877819240093231, 0.008108013309538364, 0.008344403468072414, 0.008595279417932034, 0.00878872536122799, 0.008991707116365433, 0.009200209751725197, 0.009371031075716019, 0.009522371925413609, 0.009735922329127789, 0.009940177202224731, 0.010065309703350067, 0.010239208117127419]
    mse_90_60 = [0.001786818029358983, 0.002273403573781252, 0.002730956766754389, 0.003161907894536853, 0.0035400032065808773, 0.003952395636588335, 0.004292439669370651, 0.004701206460595131, 0.005014939233660698, 0.005345167126506567, 0.005612711887806654, 0.00593501515686512, 0.006216561421751976, 0.0064219096675515175, 0.006684798747301102, 0.006950632203370333, 0.007159413769841194, 0.007432576734572649, 0.007657869253307581, 0.007892397232353687, 0.008130784146487713, 0.008301796391606331, 0.008502484299242496, 0.008683232590556145, 0.008889332413673401, 0.009056121110916138, 0.009172353893518448, 0.009307218715548515, 0.009499354287981987, 0.009679474867880344, 0.009792475029826164, 0.009930280037224293, 0.009998598136007786, 0.010144926607608795, 0.010277556255459785, 0.010390061885118484, 0.010484798811376095, 0.010612512938678265, 0.010678622871637344, 0.010811656713485718, 0.01088424026966095, 0.010964720509946346, 0.01100864727050066, 0.011109180748462677, 0.011169467121362686, 0.011236517690122128, 0.011316752061247826, 0.011404692195355892, 0.011494225822389126, 0.011488335207104683, 0.011586954817175865, 0.011665115132927895, 0.011624094098806381, 0.011655456386506557, 0.011692844331264496, 0.01169782318174839, 0.011746049858629704, 0.01178721897304058, 0.011790527030825615, 0.011783828027546406]
    mse_90_150 = [0.002460610354319215, 0.0028566275723278522, 0.003152084769681096, 0.0034760828129947186, 0.0038222670555114746, 0.004170375410467386, 0.004580297041684389, 0.004896764177829027, 0.005172243807464838, 0.0054074847139418125, 0.0056981248781085014, 0.006009729113429785, 0.006207730155438185, 0.0064769466407597065, 0.006802255287766457, 0.007003156002610922, 0.007187412586063147, 0.0074110920540988445, 0.007616361603140831, 0.007898552343249321, 0.00798914022743702, 0.00825620535761118, 0.008440128527581692, 0.008614645339548588, 0.008774864487349987, 0.008949404582381248, 0.009162863716483116, 0.009337663650512695, 0.009459472261369228, 0.009699713438749313, 0.00976357702165842, 0.009957880713045597, 0.010115513578057289, 0.010270733386278152, 0.010335846804082394, 0.010440925136208534, 0.010519515722990036, 0.01072514895349741, 0.010808134451508522, 0.01089596375823021, 0.011105147190392017, 0.011179466731846333, 0.011310684494674206, 0.011329051107168198, 0.01145793404430151, 0.01147613674402237, 0.01166479755192995, 0.011732393875718117, 0.011793571524322033, 0.011809793300926685, 0.011862952262163162, 0.012020109221339226, 0.011926790699362755, 0.011980069801211357, 0.01197663601487875, 0.012206653133034706, 0.012226671911776066, 0.01220491249114275, 0.012446694076061249, 0.01239433977752924, 0.012414601631462574, 0.012454058043658733, 0.012591369450092316, 0.012539887800812721, 0.012508259154856205, 0.012697473168373108, 0.012680517509579659, 0.012708778493106365, 0.012922022491693497, 0.01297361683100462, 0.012908612377941608, 0.013015910983085632, 0.01313269603997469, 0.013189403340220451, 0.01323308888822794, 0.013158748857676983, 0.01331831980496645, 0.013507326133549213, 0.013395585119724274, 0.013442069292068481, 0.01355027873069048, 0.013731018640100956, 0.01375796552747488, 0.01385451015084982, 0.013987916521728039, 0.013986652716994286, 0.014150586910545826, 0.01423113513737917, 0.01428971253335476, 0.014312882907688618, 0.014361381530761719, 0.014404905959963799, 0.014471474103629589, 0.014459565281867981, 0.014549070037901402, 0.01462080143392086, 0.014603340066969395, 0.014810997992753983, 0.014766343869268894, 0.014727145433425903, 0.014835130423307419, 0.014783167280256748, 0.01477260421961546, 0.014875237829983234, 0.014770200476050377, 0.014867936260998249, 0.01490157749503851, 0.014887862838804722, 0.014860393479466438, 0.014974730089306831, 0.014901949092745781, 0.014965103939175606, 0.014951540157198906, 0.014917111955583096, 0.01487391535192728, 0.0147985415533185, 0.014903179369866848, 0.014847110025584698, 0.014809210784733295, 0.014816846698522568, 0.01478583924472332, 0.014784131199121475, 0.014791671186685562, 0.01468058954924345, 0.014726480469107628, 0.014679021202027798, 0.014592335559427738, 0.014649294316768646, 0.014564380049705505, 0.014493455179035664, 0.014516017399728298, 0.014464061707258224, 0.01445127371698618, 0.014415119774639606, 0.01441259030252695, 0.014431395567953587, 0.014324525371193886, 0.014241564087569714, 0.014269712381064892, 0.014255140908062458, 0.01419747993350029, 0.014199883677065372, 0.014106080867350101, 0.014122908003628254, 0.014059990644454956, 0.014000202529132366, 0.013934546150267124, 0.013915453106164932, 0.013851216062903404, 0.013783389702439308]
    # plot
    # plt.plot(mse_90_1, label='90-1')
    plt.plot(mse_90_10, label='90-10')
    # plt.plot(mse_90_30, label='90-30')
    plt.plot(mse_90_60, label='90-60')
    plt.plot(mse_90_150, label='90-150')
    plt.xlabel('Prediction Horizon/frame')
    plt.ylabel('Loss')
    plt.legend()
    plt.savefig('./data/fig/graphgru_loss_different_future.png')


if __name__ == '__main__':

    
    # plot_loss()
    # plot_loss_from_string()
    # plot_test_loss(test_loss_list=[test_lost_list[-1]])
    plot_loss_with_some_points()
    # plot_different_future()